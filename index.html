<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>IoT Fuzzy Infrared Therapy (WIB)</title>

  <!-- Firebase SDK v9 (compat) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <style>
    body { background:linear-gradient(135deg,#e0f7fa,#80deea); font-family:'Poppins',sans-serif; color:#004d40; text-align:center; padding:20px; }
    .card{ background:white; display:inline-block; padding:15px; margin:8px; border-radius:16px; box-shadow:0 4px 10px rgba(0,0,0,0.2); width:200px; }
    .value{ font-size:28px; font-weight:bold; margin-top:10px; color:#00796b; }
    .buttonStop{ background-color:#e53935; color:white; border:none; border-radius:10px; padding:10px 20px; font-size:16px; cursor:pointer; margin-top:15px; }
    input{ width:50px; }
  </style>
</head>
<body>

<h1>ğŸŒ¡ IoT Fuzzy Infrared Therapy</h1>

<div class="card"><h3>ğŸ•’ Waktu (WIB)</h3><div id="jam" class="value">--:--:--</div></div>
<div class="card"><h3>ğŸŒ¡ Suhu (Â°C)</h3><div id="suhu" class="value">--</div></div>
<div class="card"><h3>ğŸ“ Jarak (cm)</h3><div id="jarak" class="value">--</div></div>
<div class="card"><h3>ğŸ”¥ Daya (%)</h3><div id="daya" class="value">--</div></div>
<div class="card"><h3>ğŸ•“ Status Timer</h3><div id="status" class="value">--</div></div>

<h3>ğŸ”§ Atur Durasi Timer</h3>
Jam <input id="durH" type="number" min="0" max="23"> :
Menit <input id="durM" type="number" min="0" max="59"> :
Detik <input id="durS" type="number" min="0" max="59">
<br><br>
<button onclick="startTimer()">Mulai Timer</button>
<br>
<button class="buttonStop" onclick="stopTimer()">Stop Timer</button>

<div style="margin-top:30px;font-size:13px;color:#555;">ESP32 â€¢ Fuzzy Logic â€¢ RTC NTP Sync â€¢ WIB</div>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyD-g4X4wy0F2SO3i8lYWdiROl5zE03Mgww",
    authDomain: "iot-fuzzy-infrared.firebaseapp.com",
    databaseURL: "https://iot-fuzzy-infrared-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "iot-fuzzy-infrared",
    storageBucket: "iot-fuzzy-infrared.firebasestorage.app",
    messagingSenderId: "236929233290",
    appId: "1:236929233290:web:2c41b02f927de250c89873"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // realtime display
  db.ref("iot/data").on("value", snap => {
    const d = snap.val();
    if(!d) return;
    jam.innerHTML = d.jam;
    suhu.innerHTML = d.suhu;
    jarak.innerHTML = d.jarak;
    daya.innerHTML = d.daya;
    status.innerHTML = d.status;
  });

  function startTimer(){
    db.ref("iot/command").set({
      action: "start",
      durH: Number(durH.value||0),
      durM: Number(durM.value||0),
      durS: Number(durS.value||0)
    });
  }

  function stopTimer(){
    db.ref("iot/command").set({ action:"stop" });
  }
</script>

</body>
</html>
